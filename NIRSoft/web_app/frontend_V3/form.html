<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NIRSoft - Analiz Formu</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="vanta-bg"></div>
  <header class="main-header">
    <div class="logo">NIRSoft</div>
    <nav class="main-nav" style="width:100%; display:flex; justify-content:flex-end;">
      <a href="index.html" style="margin-left:auto;">Ana Sayfa</a>
    </nav>
  </header>
  <main class="form-section">
    <div class="form-container">
      <h2>Analiz Başlat</h2>
      <form id="analysisForm">
        <label for="name">Ad Soyad:</label>
        <input type="text" id="name" name="name" required>
        <label for="gender">Cinsiyet:</label>
        <select id="gender" name="gender">
          <option value="">Seçiniz</option>
          <option value="Male">Erkek</option>
          <option value="Female">Kadın</option>
        </select>
        <label for="dob">Doğum Tarihi:</label>
        <input type="date" id="dob" name="dob">
        <label for="analysis_date">Analiz Tarihi:</label>
        <input type="date" id="analysis_date" name="analysis_date">
        <label for="protocol">Protokol:</label>
        <input type="text" id="protocol" name="protocol">
        <label for="diagnosis">Tanı:</label>
        <input type="text" id="diagnosis" name="diagnosis">
        <label for="notes">Notlar:</label>
        <textarea id="notes" name="notes" rows="3" style="resize:none; min-height:80px; max-height:80px;"></textarea>
        <label for="nirs_file">.nirs Dosyası:</label>
        <input type="file" id="nirs_file" name="nirs_file" accept=".nirs" required>
        <div class="trigger-selection">
          <h3>Trigger Seçimi</h3>
          <label for="startTrigger">Başlangıç Trigger:</label>
          <select id="startTrigger" name="startTrigger"></select>

          <label for="endTrigger">Bitiş Trigger:</label>
          <select id="endTrigger" name="endTrigger"></select>
        </div>
        <div style="display: flex; flex-direction: column; align-items: center; gap: 16px;">
          <button type="submit" class="get-started">Analiz Et</button>
          <button type="button" class="get-started" onclick="window.location.href='sonuc.html'" style="background: #3a8dde;">Analiz Sonuçlarını Gör</button>
        </div>
      </form>
    </div>
  </main>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r121/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.net.min.js"></script>
  <script>
    VANTA.NET({
      el: "#vanta-bg",
      mouseControls: true,
      touchControls: true,
      minHeight: 200.00,
      minWidth: 200.00,
      scale: 1.00,
      scaleMobile: 1.00,
      color: 0x3a8dde,
      backgroundColor: 0x0a0f1a,
      points: 12.00,
      maxDistance: 22.00,
      spacing: 18.00
    });
  </script>
  <script src="script.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
      const startTriggerSelect = document.getElementById('startTrigger');
      const endTriggerSelect = document.getElementById('endTrigger');

      try {
        const response = await fetch('/api/data');
        const data = await response.json();

        if (data.status === 'success') {
          const triggers = data.triggers.indices;
          triggers.forEach((trigger, index) => {
            const option = document.createElement('option');
            option.value = trigger;
            option.textContent = `Trigger ${index + 1}`;
            startTriggerSelect.appendChild(option);
            endTriggerSelect.appendChild(option.cloneNode(true));
          });
        }
      } catch (error) {
        console.error('Trigger bilgileri alınamadı:', error);
      }
    });
  </script>
</body>
</html>
